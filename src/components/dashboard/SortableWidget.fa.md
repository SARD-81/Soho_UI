# SortableWidget.tsx

## نمای کلی
کامپوننت `SortableWidget` یک کانتینر قابل مرتب‌سازی است که به کاربران امکان می‌دهد ویجت‌ها را در داشبورد با کشیدن و رها کردن جابجا کنند. این کامپوننت از کتابخانه `dnd-kit` برای پیاده‌سازی عملکرد کشیدن و رها کردن استفاده می‌کند.

## ساختار فایل و اجزاء به تفصیل

### دستورات واردات
- کامپوننت‌های Material UI: `Box`, `Fade`, `IconButton`, `Tooltip`
- نوع `ReactNode` از 'react': نوع برای فرزندان React
- `MdDragIndicator` از 'react-icons/md': آیکون نشانگر کشیدن
- `useSortable` از '@dnd-kit/sortable': هوک برای ایجاد عملکرد کشیدن و رها کردن
- `CSS` از '@dnd-kit/utilities': ابزارکاری برای تبدیل تبدیل‌های CSS

### تعریف رابط (`SortableWidgetProps`)
```ts
interface SortableWidgetProps {
  id: string;
  customizing: boolean;
  children: ReactNode;
  title?: string;
}
```
- تعریف نوع props مورد انتظار توسط کامپوننت
- `id`: شناسه منحصر به فرد برای ویجت قابل مرتب‌سازی
- `customizing`: نشان می‌دهد که آیا حالت سفارشی‌سازی فعال است یا خیر
- `children`: محتوای داخلی ویجت (کامپوننت فرزند)
- `title`: عنوان اختیاری برای ویجت (برای نمایش در راهنما)

### تجزیه Props کامپوننت
```ts
const { id, customizing, children, title }: SortableWidgetProps
```
- تمام props ارسالی به کامپوننت را استخراج می‌کند

### هوک مرتب‌سازی
```ts
const { attributes, listeners, setNodeRef, transform, transition, isDragging } =
  useSortable({ id, disabled: !customizing });
```
- استفاده از هوک `useSortable` از کتابخانه dnd-kit
- دریافت ویژگی‌های لازم برای مدیریت کشیدن و رها کردن
- غیرفعال کردن قابلیت کشیدن در صورت غیرفعال بودن حالت سفارشی‌سازی

### مدیریت انتقال و استایل
```ts
const composedTransition =
  transition ??
  'transform 360ms cubic-bezier(0.22, 1, 0.36, 1), opacity 220ms ease, filter 220ms ease';
const style = {
  transform: CSS.Transform.toString(transform),
  transition: composedTransition,
};
```
- ترکیب انتقال تعریف شده توسط dnd-kit با انتقال پیش‌فرض
- ایجاد استایل برای تبدیل و انتقال ویجت

### ساختار JSX اصلی
کامپوننت یک کانتینر `Box` اصلی رندر می‌کند که شامل موارد زیر است:

#### کانتینر اصلی
- دارای استایل مکان‌یابی نسبی و اندازه 100%
- مدیریت z-index بر اساس وضعیت کشیدن
- حالت‌های hover، active و isDragging با افکت‌های بصری مختلف
- استفاده از blur و افکت‌های سایه برای تعامل بهتر

#### دکمه جابجایی (شرطی)
```ts
<Fade in={customizing} unmountOnExit>
  <Box>
    <Tooltip title={title != null ? `جابجایی ${title}` : 'جابجایی ویجت'}>
      <IconButton
        size="small"
        color="inherit"
        {...listeners}
        {...attributes}
        sx={{ cursor: 'grab', '&:active': { cursor: 'grabbing' } }}
      >
        <MdDragIndicator />
      </IconButton>
    </Tooltip>
  </Box>
</Fade>
```
- نمایش دکمه جابجایی فقط در حالت سفارشی‌سازی
- استفاده از انیمیشن Fade برای نمایش/پنهان شدن نرم
- راهنما با عنوان ویجت یا پیام پیش‌فرض
- اعمال listeners و attributes از dnd-kit برای فعال کردن کشیدن
- تغییر نشانگر مکان نما در حین فعالیت

#### فرزندان
- ارائه محتوای ویجت از طریق props فرزندان

### مدیریت وضعیت کشیدن
- افزایش z-index در حین کشیدن برای نمایش قابل مشاهده
- اعمال فیلتر روشنایی متفاوت در حین کشیدن
- افکت‌های بصری متفاوت برای حالت‌های تعامل کاربر

### انیمیشن‌ها و انتقال‌ها
- استفاده از منحنی cubic-bezier برای انتقال روان
- اعمال افکت‌های بصری در حین hover و active
- مدیریت انیمیشن‌های تغییر موقعیت از طریق dnd-kit

## هدف و عملکرد
- ارائه یک کانتینر قابل مرتب‌سازی برای ویجت‌های داشبورد
- فعال/غیرفعال کردن قابلیت کشیدن بر اساس وضعیت سفارشی‌سازی
- نمایش دکمه جابجایی فقط در حالت سفارشی‌سازی
- ارائه بازخورد بصری در حین تعامل
- حفظ سازگاری با کتابخانه dnd-kit برای کشیدن و رها کردن

## Props
- `id`: شناسه منحصر به فرد برای ویجت
- `customizing`: نشان می‌دهد که آیا حالت سفارشی‌سازی فعال است
- `children`: محتوای داخلی ویجت
- `title`: عنوان اختیاری برای نمایش در راهنما

## ویژگی‌های کلیدی
- ادغام با کتابخانه dnd-kit برای کشیدن و رها کردن
- مدیریت هوشمند وضعیت کشیدن و تعاملات کاربر
- نمایش شرطی دکمه جابجایی
- انیمیشن‌های روان و بازخورد بصری
- پشتیبانی از تم تاریک و روشن
- امنیت از نظر نوع (Type-safe)
- سازگاری با کامپوننت‌های مختلف از طریق props فرزندان
- استفاده از فیلتر blur برای ظاهر مدرن